FROM golang:1.13

ENV GO111MODULE=on
RUN go env -w GOPROXY=direct

RUN go get k8s.io/code-generator/cmd/defaulter-gen@kubernetes-1.14.9
RUN go get k8s.io/code-generator/cmd/client-gen@kubernetes-1.14.9
RUN go get k8s.io/code-generator/cmd/lister-gen@kubernetes-1.14.9
RUN go get k8s.io/code-generator/cmd/informer-gen@kubernetes-1.14.9
RUN go get k8s.io/code-generator/cmd/deepcopy-gen@kubernetes-1.14.9

ARG repo

RUN mkdir -p "${GOPATH}/src/$repo"

WORKDIR $GOPATH/bin
COPY scripts/generate-groups.sh .

VOLUME "${GOPATH}/src/$repo"